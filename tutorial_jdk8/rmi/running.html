<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    

<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Running the Example Programs (The Java&trade; Tutorials &gt;        
            RMI)
</title>

     <meta name="description" content="This RMI Java tutorial describes the Java RMI system. It walks through a complete client/server example" />
     <meta name="keywords" content="java programming, learn java, java sample code, java rmi, java client server" />
        
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: left;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
        margin-right: 10px;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }
    
    #Footer2 {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #F90000;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #F90000;
        font-family: sans-serif;
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }
</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    </head>
<body onload="load()">
    <noscript>
        A browser with JavaScript enabled is required for this page to operate properly.
    </noscript>

    <div id="TopBar"> <div id="TopBar_tr"> <div id="TopBar_tl"> <div id="TopBar_br"> <div id="TopBar_bl"> 
                        <div id="TopBar_right"> 
                            <a target="_blank"
				href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">Download Ebooks</a><br />
                            <a target="_blank"
                                href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Download JDK</a>
                            <br />
                            <a href="../search.html" target="_blank">Search Java Tutorials</a>
                            <br />
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class="PrintHeaders">
        <b>Trail:</b> RMI
        <br /><b>Section:</b> Compiling and Running the Example
    </div>

    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkAHEAD"><a href="overview.html">An Overview of RMI Applications</a></div>
<div class="linkAHEAD"><a href="server.html">Writing an RMI Server</a></div>
<div class="linkBHEAD"><a href="designing.html">Designing a Remote Interface</a></div>
<div class="linkBHEAD"><a href="implementing.html">Implementing a Remote Interface</a></div>
<div class="linkAHEAD"><a href="client.html">Creating a Client Program</a></div>
<div class="linkAHEAD"><a href="example.html">Compiling and Running the Example</a></div>
<div class="linkBHEAD"><a href="compiling.html">Compiling the Example Programs</a></div>
<div class="nolinkBHEAD">Running the Example Programs</div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
            <span id="BreadCrumbs">
                <a href="../index.html" target="_top">Home Page</a>
                &gt;
                <a href="./index.html" target="_top">RMI</a>
            </span>
            <div class="NavBit">
                <a target="_top" href="compiling.html">&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target="_top" href="./TOC.html">Trail</a>&nbsp;&bull;&nbsp;<a target="_top" href="./end.html">Next&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle"><h1>Running the Example Programs</h1></div>
            <div id="PageContent">

<h2>A Note About Security</h2>
<p>The server and client programs run with a security manager installed. When you run either program, you need to specify a security policy file so that the code is granted the security permissions it needs to run. Here is an example <a href="examples/server.policy">policy file to use with the server program</a>:</p>
<div class="codeblock"><pre>
grant codeBase "file:/home/ann/src/" {
    permission java.security.AllPermission;
};
</pre></div>
<p>Here is an example <a href="examples/client.policy">policy file to use with the client program</a>:</p>
<div class="codeblock"><pre>
grant codeBase "file:/home/jones/src/" {
    permission java.security.AllPermission;
};
</pre></div>
<p>For both example policy files, all permissions are granted to the classes in the program&#39;s local class path, because the local application code is trusted, but no permissions are granted to code downloaded from other locations. Therefore, the compute engine server restricts the tasks that it executes (whose code is not known to be trusted and might be hostile) from performing any operations that require security permissions. The example client&#39;s <code>Pi</code> task does not require any permissions to execute.</p>
<p>In this example, the policy file for the server program is named <code>server.policy</code>, and the policy file for the client program is named <code>client.policy</code>.</p>
<h2>Starting the Server</h2>
<p>Before starting the compute engine, you need to start the RMI registry. The RMI registry is a simple server-side bootstrap naming facility that enables remote clients to obtain a reference to an initial remote object. It can be started with the <code>rmiregistry</code> command. Before you execute <code>rmiregistry</code>, you must make sure that the shell or window in which you will run <code>rmiregistry</code> either has no <code>CLASSPATH</code> environment variable set or has a <code>CLASSPATH</code> environment variable that does not include the path to any classes that you want downloaded to clients of your remote objects.</p>
<p>To start the registry on the server, execute the <code>rmiregistry</code> command. This command produces no output and is typically run in the background. For this example, the registry is started on the host <code>mycomputer</code>.</p>
<p><strong>Microsoft Windows</strong> (use <code>javaw</code> if <code>start</code> is not available):</p>
<div class="codeblock"><pre>
start rmiregistry
</pre></div>
<p><strong>Solaris OS or Linux</strong>:</p>
<div class="codeblock"><pre>
rmiregistry &amp;
</pre></div>
<p>By default, the registry runs on port 1099. To start the registry on a different port, specify the port number on the command line. Do not forget to unset your <code>CLASSPATH</code> environment variable.</p>
<p><strong>Microsoft Windows</strong>:</p>
<div class="codeblock"><pre>
start rmiregistry 2001
</pre></div>
<p><strong>Solaris OS or Linux</strong>:</p>
<div class="codeblock"><pre>
rmiregistry 2001 &amp;
</pre></div>
<p>Once the registry is started, you can start the server. You need to make sure that both the <code>compute.jar</code> file and the remote object implementation class are in your class path. When you start the compute engine, you need to specify, using the <code>java.rmi.server.codebase</code> property, where the server&#39;s classes are network accessible. In this example, the server-side classes to be made available for downloading are the <code>Compute</code> and <code>Task</code> interfaces, which are available in the <code>compute.jar</code> file in the <code>public_html\classes</code> directory of user <code>ann</code>. The compute engine server is started on the host <code>mycomputer</code>, the same host on which the registry was started.</p>
<p><strong>Microsoft Windows</strong>:</p>
<div class="codeblock"><pre>
java -cp c:\home\ann\src;c:\home\ann\public_html\classes\compute.jar
     -Djava.rmi.server.codebase=file:/c:/home/ann/public_html/classes/compute.jar
     -Djava.rmi.server.hostname=mycomputer.example.com
     -Djava.security.policy=server.policy
        engine.ComputeEngine
</pre></div>
<p><strong>Solaris OS or Linux</strong>:</p>
<div class="codeblock"><pre>
java -cp /home/ann/src:/home/ann/public_html/classes/compute.jar
     -Djava.rmi.server.codebase=http://mycomputer/~ann/classes/compute.jar
     -Djava.rmi.server.hostname=mycomputer.example.com
     -Djava.security.policy=server.policy
        engine.ComputeEngine
</pre></div>
<p>The above <code>java</code> command defines the following system properties:</p>
<ul>
<li>The <code>java.rmi.server.codebase</code> property specifies the location, a codebase URL, from which the definitions for classes originating <i>from</i> this server can be downloaded. If the codebase specifies a directory hierarchy (as opposed to a JAR file), you must include a trailing slash at the end of the codebase URL.</li>
<li>The <code>java.rmi.server.hostname</code> property specifies the host name or address to put in the stubs for remote objects exported in this Java virtual machine. This value is the host name or address used by clients when they attempt to communicate remote method invocations. By default, the RMI implementation uses the server&#39;s IP address as indicated by the <code>java.net.InetAddress.getLocalHost</code> API. However, sometimes, this address is not appropriate for all clients and a fully qualified host name would be more effective. To ensure that RMI uses a host name (or IP address) for the server that is routable from all potential clients, set the <code>java.rmi.server.hostname</code> property.</li>
<li>The <code>java.security.policy</code> property is used to specify the policy file that contains the permissions you intend to grant.</li>
</ul>
<h2>Starting the Client</h2>
<p>Once the registry and the compute engine are running, you can start the client, specifying the following:</p>
<ul>
<li>The location where the client serves its classes (the <code>Pi</code> class) by using the <code>java.rmi.server.codebase</code> property</li>
<li>The <code>java.security.policy</code> property, which is used to specify the security policy file that contains the permissions you intend to grant to various pieces of code</li>
<li>As command-line arguments, the host name of the server (so that the client knows where to locate the <code>Compute</code> remote object) and the number of decimal places to use in the 
<img src="../figures/rmi/pi.gif" width="9" height="9" alt="the pi symbol" /> calculation</li>
</ul>
<p>Start the client on another host (a host named <code>mysecondcomputer</code>, for example) as follows:</p>
<hr />
<p><strong>Microsoft Windows</strong>:</p>
<div class="codeblock"><pre>
java -cp c:\home\jones\src;c:\home\jones\public_html\classes\compute.jar
     -Djava.rmi.server.codebase=file:/c:/home/jones/public_html/classes/
     -Djava.security.policy=client.policy
        client.ComputePi mycomputer.example.com 45
</pre></div>
<p><strong>Solaris OS or Linux</strong>:</p>
<div class="codeblock"><pre>
java -cp /home/jones/src:/home/jones/public_html/classes/compute.jar
     -Djava.rmi.server.codebase=http://mysecondcomputer/~jones/classes/
     -Djava.security.policy=client.policy
        client.ComputePi mycomputer.example.com 45
</pre></div>
<p>Note that the class path is set on the command line so that the interpreter can find the client classes and the JAR file containing the interfaces. Also note that the value of the <code>java.rmi.server.codebase</code> property, which specifies a directory hierarchy, ends with a trailing slash.</p>
<p>After you start the client, the following output is displayed:</p>
<div class="codeblock"><pre>
3.141592653589793238462643383279502884197169399
</pre></div>
<p>The following figure illustrates where the <code>rmiregistry</code>, the <code>ComputeEngine</code> server, and the <code>ComputePi</code> client obtain classes during program execution.</p>
<center><img src="../figures/rmi/rmi-5.gif" width="400" height="182" align="bottom" alt="the registry, the compute engine, and the client obtaining classes during program execution" /></center><p>When the <code>ComputeEngine</code> server binds its remote object reference in the registry, the registry downloads the <code>Compute</code> and <code>Task</code> interfaces on which the stub class depends. These classes are downloaded from either the <code>ComputeEngine</code> server&#39;s web server or file system, depending on the type of codebase URL used when starting the server.</p>
<p>Because the <code>ComputePi</code> client has both the <code>Compute</code> and the <code>Task</code> interfaces available in its class path, it loads their definitions from its class path, not from the server&#39;s codebase.</p>
<p>Finally, the <code>Pi</code> class is loaded into the <code>ComputeEngine</code> server&#39;s Java virtual machine when the <code>Pi</code> object is passed in the <code>executeTask</code> remote call to the <code>ComputeEngine</code> object. The <code>Pi</code> class is loaded by the server from either the client&#39;s web server or file system, depending on the type of codebase URL used when starting the client.</p>


        </div>
        <div class="NavBit">
            <a target="_top" href="compiling.html">&laquo; Previous</a>
            &bull;
            <a target="_top" href="./TOC.html">Trail</a>
            &bull;
            <a target="_top" href="./end.html">Next &raquo;</a>
        </div>
    </div>
    <div id="Footer2">
<hr />
<div id="TagNotes">
    <p class="footertext">Problems with the examples? Try <a target="_blank"
        href="../information/run-examples.html">Compiling and Running
        the Examples: FAQs</a>.
    <br />
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://docs.oracle.com/javase/feedback.html">Give
    us your feedback</a>.
    </p>
</div> 

<div id="Footer">
<p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner 
 is subject to these <a href="../information/cpyr.html">legal notices</a>.
</p>
<table border="0" cellspacing="0" cellpadding="5" summary="">
    <tr>
         <td width="20%">
	 <table width="100%" border="0" cellspacing="0" cellpadding="5">
            <tr>
              <td headers="h1" align="center"><img id="duke" src="../images/DukeWave.gif" width="55" height="55" alt="duke image" /></td>
              <td headers="h2" align="left" valign="middle"><img id="oracle" src="../images/logo_oracle_footer.gif" width="100" height="29" alt="Oracle logo" /></td>
           </tr>
          </table>
          </td>

          <td width="55%" valign="middle" align="center">
		<p class="footertext"><a href="http://www.oracle.com/us/corporate/index.html">About Oracle</a> | <a href="http://www.oracle.com/technology/index.html">Oracle Technology Network</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">Terms of Use</a></p> 
	 </td>
          <td width="25%" valign="middle" align="right">
      		<p class="footertext">Copyright &copy; 1995, 2014 Oracle and/or its affiliates. All rights reserved.</p>
	 </td>
     </tr>     
</table>
</div>
    </div>
    <div class="PrintHeaders">
        <b>Previous page:</b> Compiling the Example Programs
        <br /><b>Next page:</b> End of Trail
    </div>
</body>
</html> 
