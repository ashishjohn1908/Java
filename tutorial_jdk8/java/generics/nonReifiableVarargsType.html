<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    

<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Non-Reifiable Types (The Java&trade; Tutorials &gt;        
            Learning the Java Language &gt; Generics (Updated))
</title>

     <meta name="description" content="This beginner Java tutorial describes fundamentals of programming in the Java programming language" />
     <meta name="keywords" content="java programming, learn java, java sample code, java objects, java classes, java inheritance, interfaces, variables, arrays, data types, operators, control flow, number, string" />
        
<style type="text/css">
    .FigureCaption   { 
        margin-left: 1in; 
        margin-right: 1in; 
        font-family: sans-serif; 
        font-size: smaller; 
        text-align: justify;
    }
    #TopBar_bl {
        background: url(../../images/java_bar_bl.gif) 0 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_br {
        background: url(../../images/java_bar_br.gif) 100% 100% no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tl {
        background: url(../../images/java_bar_tl.gif) 0 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar_tr {
        background: url(../../images/java_bar_tr.gif) 100% 0 no-repeat;
        width: 100%;
        height: 60px;
    }
    #TopBar {
        background: #35556B url(../../images/java_bar.gif);
        margin: 10px 10px 0 10px;
        height:60px;
        min-width:700px;
        color: white;
        font-family: sans-serif; 
        font-weight: bold;
    }
    @media print {
        #BreadCrumbs, #Download {
            display: none;
        }
    }
    #TopBar_right {
        line-height: 14px;
        float: right;
        padding-top: 2px;
        padding-right: 30px;
        text-align: left;
    }
    @media print {
        #TopBar_right {
            display: none;
        }
    }
    #TopBar_right a {
        font-size: 12px;
        margin: 3px;
        padding: 0;
    }
    #TopBar a:visited, #TopBar a:link {
        color: white;
        text-decoration: none;
    }
    #TopBar a:hover, #TopBar a:active  {
        background-color: white;
        color: #35556B;
    }
    #BreadCrumbs {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
        float: right;
    }
    #BreadCrumbs a {
        color: blue;
    }
    #BreadCrumbs a:visited, #BreadCrumbs a:link {
        text-decoration: none;
    }
    #BreadCrumbs a:hover, #BreadCrumbs a:active {
        text-decoration: underline;
    }
    #PageTitle {
        margin: 0 5px 0.5em 0;
        color: #F90000;
    }    
    #PageContent{
        margin: 0 5px 0 20px;
    }
    .LeftBar_shown {
        width: 13em;
        float: left;
        margin-left: 10px;
        margin-top: 4px;
        margin-bottom: 2em;
        margin-right: 10px;
    }
    @media print {
        .LeftBar_shown {
            display: none;
        }
    }
    .LeftBar_hidden {
        display: none;
    }
    #Footer {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    
    .footertext {
        font-size: 10px;
        font-family: sans-serif; 
        margin-top: 1px;
    }
    
    #Footer2 {
        padding-top: 10px;
        padding-left: 10px;
        margin-right: 10px;
    }
    .NavBit  {
        padding: 4px 5px 0.5em 0;
        font-family: sans-serif; 
    }
    @media print {
        .NavBit {
            display: none;
        }
    }
    #TagNotes {
        text-align: right;        
    }
    
    @media print {
        #TagNotes a:visited, #TagNotes a:link {
            color: #35556B;
            text-decoration: none;
        }
    }
    #Contents a, .NavBit a, #TagNotes a {
        color: blue
    }
    #TagNotes a:visited, #TagNotes a:link,
    #Contents a:visited, #Contents a:link,
    .NavBit a:visited, .NavBit a:link {
        text-decoration: none;
    }
    #TagNotes a:hover, #TagNotes a:active,   
    #Contents a:hover, #Contents a:active,   
    .NavBit a:hover, .NavBit a:active {  
        text-decoration: underline;
    }
    #Contents {
        float: left;
        font-family: sans-serif; 
    }
    @media print {
        #Contents {
            display: none;
        }
    }
    @media screen {
        div.PrintHeaders {
            display: none;
        }
    }
    .linkLESSON, .nolinkLESSON {
        margin-left: 0.5em;
        text-indent: -0.5em
    }
    .linkAHEAD, .nolinkAHEAD, .linkQUESTIONS, .nolinkQUESTIONS   {
        margin-left: 1.5em; 
        text-indent: -0.5em
    }
    .linkBHEAD, .nolinkBHEAD   {
        margin-left: 2.5em;
        text-indent: -0.5em
    }
    .linkCHEAD, .nolinkCHEAD   {
        margin-left: 3.5em;
        text-indent: -0.5em
    }
    .nolinkLESSON, .nolinkAHEAD, .nolinkBHEAD, .nolinkCHEAD,
    .nolinkQUESTIONS {
        font-weight: bold;
        color: #F90000;
    }
    .MainFlow_indented {
        margin-right: 10px;
        margin-left: 15em;
        margin-bottom: 2em;

    }
    .MainFlow_wide {
        margin-right: 10px;
        margin-left: 10px;
        margin-bottom: 2em;

    }
    @media print {
        .MainFlow_indented, .MainFlow_wide {
            padding-top: 0;
            margin-top: 10px;
            margin-right: 10px;
            margin-left: 0;
        }
    }
    h1, h2, h3, h4, h5 {
        color: #F90000;
        font-family: sans-serif;
    }

    h1 {
        font-weight: bold;
        font-size: 20px;
    }

    h2 {
        font-weight: bold;
        font-size: 17px;
    }

    h3 {
        font-weight: bold;
        font-size: 14px;
    }

    h4 {
        font-size: 15px;
    }

    h5 {
        font-size: 12px;
    }


    #ToggleLeft {
        display: none;
    }
    
    .note {
        margin: 0 30px 0px 30px;
    }
    
    .codeblock {
        margin: 0 30px 0px 30px;
    }
    
    .tocli {
        list-style-type:none;
    }

    .betadraft {
        color: red;
    }
</style>
<script type="text/javascript">
/* <![CDATA[ */
    function leftBar() {
        var nameq = 'tutorial_showLeftBar='
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookieString = cookies[i];
            while (cookieString.charAt(0) == ' ') {
                cookieString = cookieString.substring(1, cookieString.length);
            }
            if (cookieString.indexOf(nameq) == 0) {
                cookieValue =  cookieString.substring(nameq.length,
                        cookieString.length);
                return cookieValue == 'yes';
            }
        }
        return true;
    }

    function showLeft(b) {
        var contents = document.getElementById("LeftBar");
        var main = document.getElementById("MainFlow");
        var toggle = document.getElementById("ToggleLeft");
        if (b) {
            contents.className = "LeftBar_shown";
            main.className = "MainFlow_indented";
            toggle.innerHTML = "Hide TOC";
            document.cookie = 'tutorial_showLeftBar=yes; path=/';
        } else {
            contents.className = "LeftBar_hidden";
            main.className = "MainFlow_wide";
            toggle.innerHTML = "Show the TOC";
            document.cookie = 'tutorial_showLeftBar=no; path=/';
        }
    }

    function toggleLeft() {
        showLeft(document.getElementById("LeftBar").className ==
                "LeftBar_hidden");
        document.getElementById("ToggleLeft").blur();
    }

    function load() {
        showLeft(leftBar());
        document.getElementById("ToggleLeft").style.display="inline";
    }

    function showCode(displayCodePage, codePath) {
        var codePathEls = codePath.split("/");
        var currDocPathEls = location.href.split("/");
        //alert ("codePathEls = " + codePathEls + "\n" + "currDocPathEls = " + currDocPathEls);
        currDocPathEls.pop(); // remove file name at the end
        while (codePathEls.length > 0) {
            if (codePathEls[0] == "..") {
                codePathEls.shift();
                currDocPathEls.pop();
            } else {
                break;
            }
        }
        var fullCodePath = currDocPathEls.join("/") + "/" + codePathEls.join("/");
        //alert ("fullCodePath = " + fullCodePath );
        if (codePath.indexOf(".java") != -1 || codePath.indexOf(".jnlp") != -1) {
            window.location.href = displayCodePage + "?code=" + encodeURI(fullCodePath);
        } else {
            window.location.href = fullCodePath;
        }
    }
/* ]]> */    
</script>


    </head>
<body onload="load()">
    <noscript>
        A browser with JavaScript enabled is required for this page to operate properly.
    </noscript>

    <div id="TopBar"> <div id="TopBar_tr"> <div id="TopBar_tl"> <div id="TopBar_br"> <div id="TopBar_bl"> 
                        <div id="TopBar_right"> 
                            <a target="_blank"
				href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">Download Ebooks</a><br />
                            <a target="_blank"
                                href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Download JDK</a>
                            <br />
                            <a href="../../search.html" target="_blank">Search Java Tutorials</a>
                            <br />
                            <a href="javascript:toggleLeft()"
                                id="ToggleLeft">Hide TOC</a>
                        </div>
                    </div> </div> </div> </div> </div>
    <div class="PrintHeaders">
        <b>Trail:</b> Learning the Java Language
        <br /><b>Lesson:</b> Generics (Updated)
        <br /><b>Section:</b> Type Erasure
    </div>

    <div id="LeftBar" class="LeftBar_shown">
        <div id="Contents">
            <div class="linkLESSON"><a href="index.html">Generics (Updated)</a></div>
<div class="linkAHEAD"><a href="why.html">Why Use Generics?</a></div>
<div class="linkAHEAD"><a href="types.html">Generic Types</a></div>
<div class="linkBHEAD"><a href="rawTypes.html">Raw Types</a></div>
<div class="linkAHEAD"><a href="methods.html">Generic Methods</a></div>
<div class="linkAHEAD"><a href="bounded.html">Bounded Type Parameters</a></div>
<div class="linkBHEAD"><a href="boundedTypeParams.html">Generic Methods and Bounded Type Parameters</a></div>
<div class="linkAHEAD"><a href="inheritance.html">Generics, Inheritance, and Subtypes</a></div>
<div class="linkAHEAD"><a href="genTypeInference.html">Type Inference</a></div>
<div class="linkAHEAD"><a href="wildcards.html">Wildcards</a></div>
<div class="linkBHEAD"><a href="upperBounded.html">Upper Bounded Wildcards</a></div>
<div class="linkBHEAD"><a href="unboundedWildcards.html">Unbounded Wildcards</a></div>
<div class="linkBHEAD"><a href="lowerBounded.html">Lower Bounded Wildcards</a></div>
<div class="linkBHEAD"><a href="subtyping.html">Wildcards and Subtyping</a></div>
<div class="linkBHEAD"><a href="capture.html">Wildcard Capture and Helper Methods</a></div>
<div class="linkBHEAD"><a href="wildcardGuidelines.html">Guidelines for Wildcard Use</a></div>
<div class="linkAHEAD"><a href="erasure.html">Type Erasure</a></div>
<div class="linkBHEAD"><a href="genTypes.html">Erasure of Generic Types</a></div>
<div class="linkBHEAD"><a href="genMethods.html">Erasure of Generic Methods</a></div>
<div class="linkBHEAD"><a href="bridgeMethods.html">Effects of Type Erasure and Bridge Methods</a></div>
<div class="nolinkBHEAD">Non-Reifiable Types</div>
<div class="linkAHEAD"><a href="restrictions.html">Restrictions on Generics</a></div>
<div class="linkQUESTIONS"><a href="QandE/generics-questions.html">Questions and Exercises</a></div>
</div>
    </div>
    <div id="MainFlow" class="MainFlow_indented">
            <span id="BreadCrumbs">
                <a href="../../index.html" target="_top">Home Page</a>
                &gt;
                <a href="../index.html" target="_top">Learning the Java Language</a>
                &gt;
                <a href="index.html" target="_top">Generics (Updated)</a>
            </span>
            <div class="NavBit">
                <a target="_top" href="bridgeMethods.html">&laquo;&nbsp;Previous</a>&nbsp;&bull;&nbsp;<a target="_top" href="../TOC.html">Trail</a>&nbsp;&bull;&nbsp;<a target="_top" href="restrictions.html">Next&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle"><h1>Non-Reifiable Types</h1></div>
            <div id="PageContent">

<!-- Using Non-Reifiable Parameters with Varargs Methods -->
<p>The section
<a class="TutorialLink" target="_top" href="erasure.html">Type Erasure</a> discusses the process where the compiler removes information related to type parameters and type arguments. Type erasure has consequences related to variable arguments (also known as <em>varargs</em> ) methods whose varargs formal parameter has a non-reifiable type. See the section
<a class="TutorialLink" target="_top" href="../javaOO/arguments.html#varargs">Arbitrary Number of Arguments</a> in
<a class="TutorialLink" target="_top" href="../javaOO/arguments.html">Passing Information to a Method or a Constructor</a> for more information about varargs methods.</p>
<p>This page covers the following topics:</p>
<ul>
<li><a href="#non-reifiable-types">Non-Reifiable Types</a></li>
<li><a href="#heap_pollution">Heap Pollution</a></li>
<li><a href="#vulnerabilities">Potential Vulnerabilities of Varargs Methods with Non-Reifiable Formal Parameters</a></li>
<li><a href="#suppressing">Preventing Warnings from Varargs Methods with Non-Reifiable Formal Parameters</a></li>
</ul>
<!-- **************************************** -->
<h2><a name="non-reifiable-types" id="non-reifiable-types">Non-Reifiable Types</a></h2>
<p>
A <em>reifiable</em> type is a type whose type information is fully available at runtime. This includes primitives, non-generic types, raw types, and invocations of unbound wildcards.</p>
<p>
<em>Non-reifiable types</em> are types where information has been removed at compile-time by type erasure &mdash; invocations of generic types that are not defined as unbounded wildcards. A non-reifiable type does not have all of its information available at runtime. Examples of non-reifiable types are <tt>List&lt;String&gt;</tt> and <tt>List&lt;Number&gt;</tt>; the JVM cannot tell the difference between these types at runtime. As shown in
<a class="TutorialLink" target="_top" href="restrictions.html">Restrictions on Generics</a>, there are certain situations where non-reifiable types cannot be used: in an <tt>instanceof</tt> expression, for example, or as an element in an array.</p>

<h2><a name="heap_pollution" id="heap_pollution">Heap Pollution</a></h2>
<p><em>Heap pollution</em> occurs when a variable of a parameterized type refers to an object that is not of that parameterized type. This situation occurs if the program performed some operation that gives rise to an unchecked warning at compile-time. An <em>unchecked warning</em> is generated if, either at compile-time (within the limits of the compile-time type checking rules) or at runtime, the correctness of an operation involving a parameterized type (for example, a cast or method call) cannot be verified. For example, heap pollution occurs when mixing raw types and parameterized types, or when performing unchecked casts.</p>
<p>
In normal situations, when all code is compiled at the same time, the compiler issues an unchecked warning to draw your attention to potential heap pollution. If you compile sections of your code separately, it is difficult to detect the potential risk of heap pollution. If you ensure that your code compiles without warnings, then no heap pollution can occur.</p>
<!-- **************************************** -->
<h2><a name="vulnerabilities" id="vulnerabilities">Potential Vulnerabilities of Varargs Methods with Non-Reifiable Formal Parameters</a></h2>
<p>Generic methods that include vararg input parameters can cause heap pollution.</p>
<p>
Consider the following <tt>ArrayBuilder</tt> class:</p>
<div class="codeblock"><pre>
public class ArrayBuilder {

  public static &lt;T&gt; void addToList (List&lt;T&gt; listArg, T... elements)
{
    for (T x : elements) {
      listArg.add(x);
    }
  }

  public static void faultyMethod(List&lt;String&gt;... l) {
    Object[] objectArray = l;     // Valid
    objectArray[0] = Arrays.asList(42);
    String s = l[0].get(0);       // ClassCastException thrown here
  }

}
</pre></div>
<p>
The following example, <tt>HeapPollutionExample</tt> uses the <tt>ArrayBuiler</tt> class:</p>
<div class="codeblock"><pre>
public class HeapPollutionExample {

  public static void main(String[] args) {

    List&lt;String> stringListA = new ArrayList&lt;String>();
    List&lt;String> stringListB = new ArrayList&lt;String>();

    ArrayBuilder.addToList(stringListA, "Seven", "Eight", "Nine");
    ArrayBuilder.addToList(stringListA, "Ten", "Eleven", "Twelve");
    List&lt;List&lt;String>> listOfStringLists =
      new ArrayList&lt;List&lt;String>>();
    ArrayBuilder.addToList(listOfStringLists,
      stringListA, stringListB);

    ArrayBuilder.faultyMethod(Arrays.asList("Hello!"), Arrays.asList("World!"));
  }
}
</pre></div>
<p>
When compiled, the following warning is produced by the definition of the <tt>ArrayBuilder.addToList</tt> method:</p>
<div class="codeblock"><pre>
warning: [varargs] Possible heap pollution from parameterized vararg type T
</pre></div>
<p>When the compiler encounters a varargs method, it translates the varargs formal parameter into an array. However, the Java programming language does not permit the creation of arrays of parameterized types. In the method <code>ArrayBuilder.addToList</code>, the compiler translates the varargs formal parameter <code>T... elements</code> to the formal parameter <code>T[] elements</code>, an array. However, because of type erasure, the compiler converts the varargs formal parameter to <code>Object[] elements</code>. Consequently, there is a possibility of heap pollution.</p>
<p>
The following statement assigns the varargs formal parameter <code>l</code> to the <code>Object</code> array <code>objectArgs</code>:</p>
<div class="codeblock"><pre>
Object[] objectArray = l;
</pre></div>
<p>This statement can potentially introduce heap pollution. A value that does match the parameterized type of the varargs formal parameter <code>l</code> can be assigned to the variable <code>objectArray</code>, and thus can be assigned to <code>l</code>. However, the compiler does not generate an unchecked warning at this statement. The compiler has already generated a warning when it translated the varargs formal parameter <code>List&lt;String&gt;... l</code> to the formal parameter <code>List[] l</code>. This statement is valid; the variable <code>l</code> has the type <code>List[]</code>, which is a subtype of <code>Object[]</code>.</p>
<p>Consequently, the compiler does not issue a warning or error if you assign a <code>List</code> object of any type to any array component of the <code>objectArray</code> array as shown by this statement:</p>
<div class="codeblock"><pre>
objectArray[0] = Arrays.asList(42);
</pre></div>
<p>This statement assigns to the first array component of the <code>objectArray</code> array with a <code>List</code> object that contains one object of type <code>Integer</code>.</p>
<p>Suppose you invoke <code>ArrayBuilder.faultyMethod</code> with the following statement:</p>
<div class="codeblock"><pre>
ArrayBuilder.faultyMethod(Arrays.asList("Hello!"), Arrays.asList("World!"));
</pre></div>
<p>At runtime, the JVM throws a <code>ClassCastException</code> at the following statement:</p>
<div class="codeblock"><pre>
// ClassCastException thrown here
String s = l[0].get(0);
</pre></div>
<p>The object stored in the first array component of the variable <code>l</code> has the type <code>List&lt;Integer&gt;</code>, but this statement is expecting an object of type <code>List&lt;String&gt;</code>.</p>
<!-- **************************************** -->
<h2><a name="suppressing" id="suppressing">Prevent Warnings from Varargs Methods with Non-Reifiable Formal Parameters</a></h2>
<p>If you declare a varargs method that has parameters of a parameterized type, and you ensure that the body of the method does not throw a <code>ClassCastException</code> or other similar exception due to improper handling of the varargs formal parameter, you can prevent the warning that the compiler generates for these kinds of varargs methods by adding the following annotation to static and non-constructor method declarations:</p>
<div class="codeblock"><pre>
@SafeVarargs
</pre></div>
<p>The <code>@SafeVarargs</code> annotation is a documented part of the method&#39;s contract; this annotation asserts that the implementation of the method will not improperly handle the varargs formal parameter.</p>
<p>
It is also possible, though less desirable, to suppress such warnings by adding the following to the method declaration:</p>
<div class="codeblock"><pre>
@SuppressWarnings({"unchecked", "varargs"})
</pre></div>
<p>However, this approach does not suppress warnings generated from the method's call site.  If you are unfamiliar with the <code>@SuppressWarnings</code> syntax, see
<a class="TutorialLink" target="_top" href="../../java/annotations/index.html">Annotations</a>.</p>

        </div>
        <div class="NavBit">
            <a target="_top" href="bridgeMethods.html">&laquo; Previous</a>
            &bull;
            <a target="_top" href="../TOC.html">Trail</a>
            &bull;
            <a target="_top" href="restrictions.html">Next &raquo;</a>
        </div>
    </div>
    <div id="Footer2">
<hr />
<div id="TagNotes">
    <p class="footertext">Problems with the examples? Try <a target="_blank"
        href="../../information/run-examples.html">Compiling and Running
        the Examples: FAQs</a>.
    <br />
    Complaints? Compliments? Suggestions? <a target="_blank"
        href="http://docs.oracle.com/javase/feedback.html">Give
    us your feedback</a>.
    </p>
</div> 

<div id="Footer">
<p class="footertext"><a name="license_info">Your use of this</a> page and all the material on pages under &quot;The Java Tutorials&quot; banner 
 is subject to these <a href="../../information/cpyr.html">legal notices</a>.
</p>
<table border="0" cellspacing="0" cellpadding="5" summary="">
    <tr>
         <td width="20%">
	 <table width="100%" border="0" cellspacing="0" cellpadding="5">
            <tr>
              <td headers="h1" align="center"><img id="duke" src="../../images/DukeWave.gif" width="55" height="55" alt="duke image" /></td>
              <td headers="h2" align="left" valign="middle"><img id="oracle" src="../../images/logo_oracle_footer.gif" width="100" height="29" alt="Oracle logo" /></td>
           </tr>
          </table>
          </td>

          <td width="55%" valign="middle" align="center">
		<p class="footertext"><a href="http://www.oracle.com/us/corporate/index.html">About Oracle</a> | <a href="http://www.oracle.com/technology/index.html">Oracle Technology Network</a> | <a href="http://www.oracle.com/us/legal/terms/index.html">Terms of Use</a></p> 
	 </td>
          <td width="25%" valign="middle" align="right">
      		<p class="footertext">Copyright &copy; 1995, 2014 Oracle and/or its affiliates. All rights reserved.</p>
	 </td>
     </tr>     
</table>
</div>
    </div>
    <div class="PrintHeaders">
        <b>Previous page:</b> Effects of Type Erasure and Bridge Methods
        <br /><b>Next page:</b> Restrictions on Generics
    </div>
</body>
</html> 
